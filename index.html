<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Agricultural Buffer Strip Recommender</title>
  <style>
    body {
      font-family: Roboto, sans-serif;
      margin: 40px;
      background: #f4f8f7;
      color: #333;
    }
    h2 {
      color: #2a6d4f;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    select {
      margin-top: 5px;
      padding: 8px;
      width: 250px;
    }
    .btn {
      margin-top: 15px;
      padding: 8px 16px;
      width: 250px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      border-radius: 4px;
    }
    .btn-primary {
      background-color: #2a6d4f;
      color: white;
    }
    .btn-primary:hover {
      background-color: #3c8b67;
    }
    .btn-secondary {
      background-color: #ccc;
      color: #333;
    }
    .btn-secondary:hover {
      background-color: #bbb;
    }
    #output {
      margin-top: 20px;
      background: #e0f3e5;
      padding: 15px;
      border-radius: 8px;
      width: fit-content;
    }
    .input-info {
      font-size: 0.9em;
      color: #555;
      margin: 5px 0 10px 0;
      max-width: 600px;
    }

    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
    }
    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 20px;
      border-radius: 10px;
      width: 80%;
      max-width: 600px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .close {
      color: #aaa;
      float: right;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
    }
    .close:hover {
      color: black;
    }
  </style>
</head>
<body>
  <h2>Agricultural Buffer Strip Recommender</h2>

<div style="overflow: auto; max-width: 800px;">
  <div style="float: right; margin-left: 20px; margin-bottom: 10px; text-align: center;">
    <img 
      src="Willow1.png" 
      alt="Willow tree (Salix spp.)" 
      width="400"
      style="display: block; margin-bottom: 5px;">
    <p style="font-size: 0.8em; color: #666; margin: 0;">
      <i>Salix spp.</i> — Source: 
      <a href="https://gardenerspath.com/plants/landscape-trees/best-willow-varieties" target="_blank" rel="noopener noreferrer">
        Gardeners Path
      </a>
    </p>
  </div>

  <!-- Form content here... (identico a prima, selettori etc.) -->

  <!-- selettori e bottoni -->
  <!-- [omesso per brevità] — tieni i tuoi <select> esistenti qui -->

  <button class="btn btn-primary" onclick="recommendBuffer()">Get Recommendation</button>
  <button class="btn btn-secondary" onclick="resetForm()">Reset</button>
  
  <div id="output"></div>
</div>

<!-- Modal window -->
<div id="vegModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h3>Suggested Vegetation Description</h3>
    <div id="vegDescription"></div>
  </div>
</div>

<script>
  function resetForm() {
    document.getElementById("slope").selectedIndex = 0;
    document.getElementById("fertilizer").selectedIndex = 0;
    document.getElementById("soil").selectedIndex = 0;
    document.getElementById("rain").selectedIndex = 0;
    document.getElementById("distance").selectedIndex = 0;
    document.getElementById("output").innerHTML = "";
  }

  function recommendBuffer() {
    const slope = document.getElementById("slope").value;
    const slopeText = document.getElementById("slope").selectedOptions[0].text;
    const fertilizer = document.getElementById("fertilizer").value;
    const soil = document.getElementById("soil").value;
    const rain = document.getElementById("rain").value;
    const distance = document.getElementById("distance").value;
    const distanceText = document.getElementById("distance").selectedOptions[0].text;

    let width = "";
    const vegetationOptions = [];

    if (slope === "lt10") {
      if (fertilizer === "Low") width = "3 meters";
      else if (fertilizer === "Moderate") width = "5 meters";
      else if (fertilizer === "High") width = "10 meters";
    } else if (slope === "gt10") {
      if (rain === "Dry") width = "5 meters";
      else if (rain === "Moderate") width = "10 meters";
      else if (rain === "Heavy") width = "12 meters";
    }

    if (distance === "lt10") {
      if (slope === "gt10") {
        vegetationOptions.push("Salix spp.");
      } else {
        vegetationOptions.push("Sambucus nigra, Viburnum opulus, Ulmus laevis, Alnus glutinosa, Carex riparia, Juncus effusus, Filipendula ulmaria, Lythrum salicaria");
      }
    } else if (distance === "10-30" && soil === "Loam") {
      vegetationOptions.push("Sambucus nigra, Quercus robur, Festuca pratensis, Lotus corniculatus, Achillea millefolium, Plantago lanceolata");
    } else if (distance === "gt30" && (slope === "gt10" || rain === "Dry")) {
      vegetationOptions.push("Festuca ovina, Anthyllis vulneraria, Bromus erectus, Poa angustifolia");
    } else {
      vegetationOptions.push("Mixed native grasses and legumes");
    }

    const vegetation = vegetationOptions.join(", ");

    document.getElementById("output").innerHTML =
      `<strong>Your Input:</strong><br>` +
      `• Field Slope: ${slopeText}<br>` +
      `• Fertilizer Use: ${fertilizer}<br>` +
      `• Soil Type: ${soil}<br>` +
      `• Precipitation Intensity: ${rain}<br>` +
      `• Distance to Water Body: ${distanceText}<br><br>` +
      `<strong>Minimum Buffer Width Requirement:</strong> ${width}<br>` +
      `<strong>Suggested Vegetation:</strong> ${vegetation}`;

    // Show modal if a match is found
    let vegDesc = "";
    if (vegetation.includes("Salix spp.")) {
      vegDesc = `<strong>Salix species (Willow trees):</strong> These fast-growing, deep-rooted trees are ideal for stabilizing streambanks and absorbing excess nutrients from runoff. Willows tolerate wet soils and can form dense buffer strips that filter sediments and reduce erosion effectively.`;
    }

    if (vegDesc !== "") {
      document.getElementById("vegDescription").innerHTML = vegDesc;
      document.getElementById("vegModal").style.display = "block";
    }
  }

  function closeModal() {
    document.getElementById("vegModal").style.display = "none";
  }

  // Optional: Close modal when clicking outside
  window.onclick = function(event) {
    const modal = document.getElementById("vegModal");
    if (event.target === modal) {
      modal.style.display = "none";
    }
  }
</script>
</body>
</html>
